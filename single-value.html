<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="http://d3js.org/d3.v6.min.js" charset="utf-8"></script>
    <link href="https://fonts.googleapis.com/css2?family=Aref+Ruqaa&family=Inter:wght@400;700&display=swap"
        rel="stylesheet" />
    <style>
        .chart-title {
            font-family: 'Aref Ruqaa', serif;
            font-size: 16px;
            fill: #333;
        }

        .highest-category {
            font-family: 'Inter', sans-serif;
            font-size: 20px;
            fill: black;
            font-weight: bold;
        }

        .highest-number {
            font-family: 'Inter', sans-serif;
            font-size: 18px;
            fill: black;
            font-weight: bold;
        }

        #chart9 {
            border-radius: 25px;
            border: 2px solid lightgray;
            padding: 20px;
            width: 150px;
            height: 100px;
        }
    </style>
</head>

<body>
    <div id="chart9"></div>
    <script>
        const createSingleValueChart = () => {
            const chartWidth = 150;
            const chartHeight = 150;
            const padding = 20;

            const innerChartWidth = chartWidth - padding;
            const innerChartHeight = chartHeight - padding;

            const svg = d3.select('#chart9')
                .append('svg')
                .attr('width', chartWidth)
                .attr('height', chartHeight);

            const g = svg.append('g')
                .attr('transform', 'translate(20, 20)')
                .attr('id', 'chart');

            svg.append('text')
                .text('The category')
                .attr('class', 'chart-title')
                .attr('x', 25)
                .attr('y', 20)

            svg.append('text')
                .text('that has')
                .attr('class', 'chart-title')
                .attr('x', 38)
                .attr('y', 35)

            svg.append('text')
                .text('most views')
                .attr('class', 'chart-title')
                .attr('x', 31)
                .attr('y', 50)

                
            var counterG = 0;
            var counterP = 0;
            var counterS = 0;
            var counterM = 0;
            var counterE = 0;
            var counterB = 0;
            var counterT = 0;
            var counterO = 0;
            var highCategory = ""
            var highestValue = 0
            const singleChartData = [];
            const highestValues = [];
            d3.csv('./top_100_youtubers.csv').then(function (data) {
                data.forEach((d) => {
                    singleChartData.push({
                    category: d.Category,
                    views: d.Views
                    });
                });

        for (let i = 0; i < singleChartData.length; i++) {

            console.log('Counter started');
            console.log(singleChartData[i].category);
            if (singleChartData[i].category == "Gaming & Apps")
            {
                counterG+=parseInt(singleChartData[i].views);
                console.log('Added to g!');
            }
            if (singleChartData[i].category == "People & Blogs")
            {
                counterP+=parseInt(singleChartData[i].views);
                console.log('Added to P!');
            }
            if (singleChartData[i].category == "Sports")
            {
                counterS+=parseInt(singleChartData[i].views);
                console.log('Added to S!');
            }
            if (singleChartData[i].category == "Music")
            {
                counterM+=parseInt(singleChartData[i].views);
                console.log('Added to M!');
            }
            if (singleChartData[i].category == "Entertainment")
            {
                counterE+=parseInt(singleChartData[i].views);
                console.log('Added to E!');
            }
            if (singleChartData[i].category == "Beauty & Fashion")
            {
                counterB+=parseInt(singleChartData[i].views);
                console.log('Added to B!');
            }
            if (singleChartData[i].category == "Science & Tech")
            {
                counterT+=parseInt(singleChartData[i].views);
                console.log('Added to T!');
            }
            if (singleChartData[i].category == "None")
            {
                counterO+=parseInt(singleChartData[i].views);
                console.log('Added to O!');
            }
        }
        var max = (Math.max(parseInt(counterB), parseInt(counterE), parseInt(counterG)
        ,parseInt(counterM), parseInt(counterO), parseInt(counterP), parseInt(counterS), parseInt(counterT)))

        if (max == parseInt(counterB)){
            console.log("B")
            highCategory = "Beauty & Fashion"
            highestValue = counterB
        }
        if (max == parseInt(counterE)){
            console.log("E")
            highCategory = "Entertainment"
            highestValue = counterE
        }
        if (max == parseInt(counterG)){
            console.log("G")
            highCategory = "Gaming & Apps"
            highestValue = counterG
        }
        if (max == parseInt(counterM)){
            console.log("M")
            highCategory = "Music"
            highestValue = counterM
        }
        if (max == parseInt(counterO)){
            console.log("O")
            highCategory = "None"

        }
        if (max == parseInt(counterP)){
            console.log("P")
            highCategory = "People & Blogs"
            highestValue = counterP
        }
        if (max == parseInt(counterS)){
            console.log("S")
            highCategory = "Sports"
            highestValue = counterS
        }
        if (max == parseInt(counterT)){
            console.log("T")
            highCategory = "Science & Tech"
            highestValue = counterT
        }


        svg.append("text")
            .text(highCategory)
            .attr("class", "highest-category")
            .attr("x", 0)
            .attr("y", 70)

        svg.append("text")
            .text(highestValue.toLocaleString("en-US"))
            .attr("class", "highest-number")
            .attr("x", 3)
            .attr("y", 90)
            })
        }
        createSingleValueChart();
    </script>
</body>

</html>